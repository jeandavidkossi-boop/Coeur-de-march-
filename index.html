<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cœur de Marché Bouaflé</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f9fafb; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 25px; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
    </style>
</head>
<body class="pb-24">

    <header class="bg-purple-900 pt-8 pb-12 rounded-b-[50px] shadow-2xl text-center border-b-4 border-orange-500">
        <div class="w-16 h-16 bg-white rounded-2xl mx-auto mb-2 flex items-center justify-center shadow-lg">
            <img src="IMG-20260115-WA0005.jpg" class="w-full h-full object-contain">
        </div>
        <h1 class="text-white text-xl font-black uppercase italic">Cœur de Marché</h1>
    </header>

    <main class="px-4 -mt-8">
        
        <div class="bg-white p-5 rounded-[35px] shadow-xl border border-gray-100 mb-6 relative z-10">
            <div class="text-center mb-4 border-b border-gray-100 pb-3">
                <h2 class="text-purple-900 font-black text-[11px] uppercase italic">Bienvenue chers Clients !</h2>
                <p class="text-gray-500 text-[9px] italic">Trouvez tout ce qu'il vous faut à Bouaflé en un clic.</p>
            </div>
            
            <div class="text-center mb-4">
                <h2 class="text-orange-600 font-black text-[11px] uppercase italic">Bienvenue chers Marchands !</h2>
                <p class="text-gray-500 text-[9px] italic">Propulsez vos produits sur le marché digital de la Marahoué.</p>
            </div>

            <div class="flex gap-2 mt-2">
                <div class="relative flex-1">
                    <input type="text" id="inputRecherche" onkeyup="rechercherProduit()" placeholder="Rechercher un article..." 
                           class="w-full bg-gray-100 rounded-xl py-3 px-10 text-[10px] outline-none border-none focus:ring-2 focus:ring-purple-900">
                    <i class="fas fa-search absolute left-4 top-3 text-gray-400"></i>
                </div>
                <button onclick="lancerMicro()" class="bg-purple-900 text-white w-10 h-10 rounded-xl flex items-center justify-center shadow-md">
                    <i class="fas fa-microphone" id="iconMicro"></i>
                </button>
            </div>
        </div>

        <div class="mb-8">
            <h3 class="text-purple-900 font-black text-[10px] uppercase mb-3 px-2 flex items-center gap-2">
                <i class="fas fa-fire text-orange-500"></i> À la Une
            </h3>
            <div id="carrousel-une" class="flex gap-4 overflow-x-auto no-scrollbar pb-2 px-1">
                </div>
        </div>

        <div class="mb-8">
            <h3 class="text-purple-900 font-black text-[10px] uppercase mb-3 px-2 flex items-center gap-2">
                <i class="fas fa-star text-orange-500"></i> Sous les Projecteurs
            </h3>
            <div class="bg-white p-3 rounded-[30px] shadow-lg border border-gray-50">
                <div class="video-container bg-gray-100" id="video-placeholder">
                    </div>
            </div>
        </div>

        <div class="mb-8 text-center">
            <h3 class="text-purple-900 font-black text-[10px] uppercase mb-4 px-2 italic">Nos Rayons</h3>
            <div class="grid grid-cols-2 gap-4">
                <button onclick="filtrerRayon('Mercerie')" class="bg-white p-5 rounded-3xl shadow-md border-b-4 border-orange-500 active:scale-95 transition-all">
                    <i class="fas fa-scissors text-orange-500 text-xl mb-2"></i>
                    <p class="text-[9px] font-black uppercase text-purple-900">Mercerie</p>
                </button>
                <button onclick="filtrerRayon('Beauté')" class="bg-white p-5 rounded-3xl shadow-md border-b-4 border-pink-500 active:scale-95 transition-all">
                    <i class="fas fa-magic text-pink-500 text-xl mb-2"></i>
                    <p class="text-[9px] font-black uppercase text-purple-900">Beauté</p>
                </button>
            </div>
        </div>

        <div id="zone-affichage" class="mb-10">
            <div class="flex justify-between items-center mb-4 px-2">
                <h3 id="titre-zone" class="text-purple-900 font-black text-[10px] uppercase italic underline decoration-orange-500">Tous les produits</h3>
                <button onclick="afficherTout()" class="text-gray-400 text-[8px] uppercase font-bold">Voir tout</button>
            </div>
            <div id="liste-produits" class="grid grid-cols-1 gap-4 px-1">
                </div>
        </div>

    </main>

    <a href="https://wa.me/2250576326645" class="fixed bottom-6 right-6 bg-green-500 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-2xl z-50 animate-bounce">
        <i class="fab fa-whatsapp text-2xl"></i>
    </a>

    <script>
        const urlScript = "https://script.google.com/macros/s/AKfycbzUAXyeFs7Fgbw1XFc3PsIk0YLpHsRRGHiz0fRp06qjSH6XwU08zMy3Q4bv0Vok4Oyk/exec";
        let articles = [];

        async function charger() {
            try {
                const res = await fetch(urlScript);
                articles = await res.json();
                afficherTout();
            } catch (e) { console.log("Erreur de connexion"); }
        }

        function afficherTout() {
            document.getElementById('titre-zone').innerText = "Tous les produits";
            // 1. À la une
            const une = articles.filter(p => p.certifie === "OUI" && p.statut === "OK");
            document.getElementById('carrousel-une').innerHTML = une.map(p => `
                <div class="min-w-[130px] bg-white rounded-2xl shadow-md overflow-hidden border border-gray-50">
                    <img src="${p.image}" class="w-full h-24 object-cover">
                    <div class="p-2 text-center text-[8px] font-black uppercase text-purple-900">${p.nom}</div>
                </div>`).join('');

            // 2. Liste complète
            const liste = articles.filter(p => p.statut === "OK");
            document.getElementById('liste-produits').innerHTML = liste.map(p => card(p)).join('');
        }

        function card(p) {
            return `
                <div class="bg-white rounded-3xl shadow-md flex items-center p-3 gap-4 border border-gray-50">
                    <img src="${p.image}" class="w-16 h-16 rounded-xl object-cover shadow-sm">
                    <div class="flex-1">
                        <h4 class="font-black uppercase text-purple-900 text-[10px]">${p.nom}</h4>
                        <p class="text-orange-600 font-black text-[10px]">${p.prix} FCFA</p>
                    </div>
                    <a href="https://wa.me/2250576326645?text=Je commande : ${p.nom}" class="bg-green-100 text-green-600 p-3 rounded-full">
                        <i class="fab fa-whatsapp text-lg"></i>
                    </a>
                </div>`;
        }

        function filtrerRayon(nom) {
            document.getElementById('titre-zone').innerText = "Marché : " + nom;
            const filtrés = articles.filter(p => p.rayon === nom && p.statut === "OK");
            document.getElementById('liste-produits').innerHTML = filtrés.map(p => card(p)).join('');
            window.scrollTo({ top: 600, behavior: 'smooth' });
        }

        function rechercherProduit() {
            const t = document.getElementById('inputRecherche').value.toLowerCase();
            const filtrés = articles.filter(p => p.nom.toLowerCase().includes(t) && p.statut === "OK");
            document.getElementById('liste-produits').innerHTML = filtrés.map(p => card(p)).join('');
        }

        function lancerMicro() {
            const rec = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            rec.lang = 'fr-FR';
            rec.onstart = () => { document.getElementById('iconMicro').className = "fas fa-spinner fa-spin text-white"; };
            rec.onend = () => { document.getElementById('iconMicro').className = "fas fa-microphone text-white"; };
            rec.onresult = (e) => {
                document.getElementById('inputRecherche').value = e.results[0][0].transcript;
                rechercherProduit();
            };
            rec.start();
        }

        window.onload = charger;
    </script>
</body>
</html>
